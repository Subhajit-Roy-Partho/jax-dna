# How to compute RNA structural properties?

We will go through from: https://arxiv.org/pdf/1403.4180

"To characterize the structure of the oxRNA duplex, we simulate a 13-base-pair duplex at 25 â—¦C using Monte Carlo simulation. We generated 30 000 decorrelated configurations that were analyzed in the following manner"
- We did this with RNA + RNA2 with VMMC, and also with RNA2 with MD

"The helical axis was fitted for each saved configuration, as described in Supplementary Material A1."
- so, the helical axis was fitted for *each* saved configuration

**Rise**: "The rise per base pair was measured as the distance between the projections of the midpoints of base pairs onto the helical axis."
- ok. but in `lp_rkk.py`, it seems to use the stack sites rather than the base sites? Should compare with `geom.py`
- in `geom.py`, there seem to be two options -- one that uses a local helical axis per bp, another that uses the helical axis for the entire strand. Only the latter seems to give results that agree. What explains the difference?
- rise should be 0.28 nm with a length scale of 0.84 nm per oxRNA length
- how many bp's are ignored / what's the offset?


Some comparisons and notes:
- `geom.py` (when using full helical axis instead of local) and our `geom` implementation agree
  - `python geom_rk.py ../jax-dna-dev/data/templates/rna2-13bp-md/output.dat ../jax-dna-dev/data/templates/rna2-13bp-md/sys.top 1 1`
  - `python3 -m jax_dna.loss.rna.geom_rise`
- these disagree with the rise as calculated for Lp calculation, but barely. Both around 2.8
   - `python3 -m jax_dna.loss.rna.rise`
   - `python rna-lp/lp_rkk.py ../jax-dna-dev/data/templates/rna2-13bp-md/output.dat ../jax-dna-dev/data/templates/rna2-13bp-md/sys.top 1 1 rna2.txt`
- all computed values are about the reported value of 0.28 nm.
  - the one computed per Lp calculation is basically exact, other one is a bit higher (~2.86 A instead of 2.8 A)
- outstanding Q for Lp calculation -- should the rise really be normalized using an underestimate (derived from a 142 bp helical axis)?
- why does the local helical axis do so badly?
- the conversion factor isn't exactly 0.84. What is it exactly?




**Twist**: "The twist per base pair was measured as the angle between the projections of the vectors connecting bases in the base pairs onto the plane perpendicular to the helical axis."
- mean turn per base pair should  be 33 deg
- how many bp's are ignored / what's the offset?
- corresponds to a pitch of 10.9 bp


Some comparisons and notes:
- `geom.py` (when using full helical axis instead of local) and our `geom` implementation agree
  - `python geom_rk.py ../jax-dna-dev/data/templates/rna2-13bp-md/output.dat ../jax-dna-dev/data/templates/rna2-13bp-md/sys.top 1 1`
  - `python3 -m jax_dna.loss.rna.geom_angle`
- Get quite close to the reported value, e.g.
  - `Pitch (# bp / turn): 10.946411429196559` vs. `10.9`
  - `Mean angle (deg): 32.88749032763363` vs. `33.0`
- note: need to ask what the offset should be


**Inclination**: "The inclination, measured as the mean angle between the vector pointing from the center of mass of a nucleotide to its base and the plane perpendicular to the helical axis"
- should be 16.1 deg
- same question about offset

Some comparisons and notes:
- haven't reimplemented, but value from `geom` is different than reported value
  - computed 18.8 deg  compared to reported of  16.1 deg
- what is inclination A  vs. inclination B (in `geom`)?


**Helical Width**: "The width of the helix is measured as twice the distance of the backbone from the axis, and includes the excluded volume interaction radius of the backbone site"
- should be 2.5 nm

Some comparisons and notes:
- get matching values with reimplementation
  - `python3 -m jax_dna.loss.rna.geom_width`
  - `python geom_rk.py ../jax-dna-dev/data/templates/rna2-13bp-md/output.dat ../jax-dna-dev/data/templates/rna2-13bp-md/sys.top 1 1`
- however, computed value doesn't match reported value
  - reported value is 2.5 nm
  - computed value is ~17.1 A
  - this appears to be without any correction for excluded volume
    - I would think that the correction (in oxDNA units) would be `sigma_backbone = 0.7` -- just add this onto every value. However, this still yields an underapproximation
- note: the calculation in the code just measures the distance between backbone sites of opposite nucleotides. Is this equivalent to twice the distance of the backbone from the axis? Because the axis doesn't necessarily run through the midpoint of the base pair.


**Groove Widths**: "The major and minor grooves in oxRNA are 0.48 nm and 1.07 nm, respectively, where we measured the groove distances in a manner analogous to a method employed by the Curves+ software for analyzing atomistic structures of DNA and RNA. For a selected nucleotide, we measured distances between its backbone site and points on a curve that was linearly interpolated through the backbone sites of the nucleotides on the opposite strand. The distances measured along the curve have two minima, one for each groove. The excluded volume interaction radius for each backbone site was subtracted from these measured distances."
- major 0.48 nm, minor 1.07 nm
- same question applies again


Some comparisons and notes:
- I would think that the releevant values in `geom` would be back-bone-distances A and B. But these give very off values.
  - why is this even a relevant quantity? shouldn't it just be the spring length, b/c it's measured on the same strand?
- roughly as expected with the groove calculation Petr sent along. 4.8 and 1.05 nm
  - run `python3 -m experiments.debug.explore_groove_calc`
  - note: if we change the basedir to the 40 bp duplex, we get slightly bigger numbers -- 0.485 and 1.078 nm
